<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VibeTarot ‚Äî Gen‚ÄëZ Online (No‚ÄëInstall)</title>
  <style>
    :root{
      --bg1:#000;
      --bg2:#0b0720;
      --glass: rgba(255,255,255,0.06);
      --glass-border: rgba(255,255,255,0.15);
      --text: #fff;
      --muted: rgba(255,255,255,.7);
      --accent1: #d946ef; /* fuchsia-500 */
      --accent2: #6366f1; /* indigo-500 */
      --accent3: #22d3ee; /* cyan-400 */
      --ok: #10b981; /* emerald-500 */
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Noto Sans Thai", "Noto Sans", Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background: linear-gradient(to bottom, var(--bg1), var(--bg2) 30%, var(--bg1));
    }
    .container{max-width:1060px; margin:0 auto; padding:24px;}
    .title{font-size:28px; font-weight:900; text-shadow:0 0 12px rgba(168,85,247,.8);}
    .muted{color:var(--muted);}
    .card{background:rgba(255,255,255,0.05); border:1px solid var(--glass-border); border-radius:16px;}
    .pad{padding:16px;}
    .row{display:grid; grid-template-columns:1fr; gap:12px;}
    @media(min-width:900px){ .row{grid-template-columns: 320px 1fr;} }
    input, textarea, select{
      width:100%; box-sizing:border-box; padding:10px 12px; border-radius:10px;
      border:1px solid var(--glass-border); background: rgba(255,255,255,0.05); color:var(--text);
    }
    label{font-size:14px; display:block; margin:6px 0;}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:10px 14px; border-radius:12px; border:1px solid var(--glass-border);
      background: rgba(255,255,255,0.08); color:var(--text); cursor:pointer; text-decoration:none;
    }
    .btn:hover{background: rgba(255,255,255,0.15);}
    .btn-primary{border:none; background: linear-gradient(90deg, var(--accent1), var(--accent2));}
    .btn-share{border:none; background: linear-gradient(90deg, var(--ok), var(--accent3));}
    .spread-grid{display:grid; grid-template-columns:1fr; gap:10px;}
    @media(min-width:700px){ .spread-grid{grid-template-columns: repeat(3, minmax(0,1fr));} }
    .choice.active{background: linear-gradient(90deg, var(--accent1), var(--accent2)); border:none;}
    .choice{height:42px;}
    .cards{display:grid; grid-template-columns:1fr; gap:12px;}
    @media(min-width:900px){ .cards{grid-template-columns: repeat(3, minmax(0,1fr));} }
    .tarot{position:relative; height:230px; border-radius:14px; overflow:hidden; border:1px solid var(--glass-border);
      background: radial-gradient(circle at 30% 20%, rgba(217,70,239,.25), transparent 30%), radial-gradient(circle at 70% 60%, rgba(99,102,241,.25), transparent 30%);
      cursor:pointer; transform-style:preserve-3d; transition: transform .5s;
    }
    .tarot .front, .tarot .back{position:absolute; inset:0; padding:14px; backface-visibility:hidden; display:flex; flex-direction:column; justify-content:space-between;}
    .tarot .front{
      background: linear-gradient(145deg, rgba(217,70,239,0.8), rgba(99,102,241,0.8));
      border:1px solid var(--glass-border);
    }
    .tarot.flipped{transform: rotateY(180deg);}
    .tarot .back{transform: rotateY(180deg); align-items:center; justify-content:center; text-align:center;}
    .hint{font-size:12px; color:var(--muted);}
    .footer{margin-top:18px; text-align:center; font-size:12px; color:rgba(255,255,255,.55);}
    .actions{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px;}
    .summary ul{padding-left:18px; margin: 8px 0;}
    .summary li{margin:6px 0;}
    .badge{font-size:10px; padding:2px 6px; border-radius:999px; background: rgba(0,0,0,.35); border:1px solid var(--glass-border);}
    .topbar{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;}
  </style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div>
        <div class="title">üîÆ VibeTarot <span style="color:#f0abfc">Online</span></div>
        <div class="muted" style="font-size:14px;margin-top:4px">Gen‚ÄëZ friendly ‚Ä¢ fast ‚Ä¢ aesthetic ‚Ä¢ no cap</div>
      </div>
      <button class="btn btn-primary" id="quickDraw">‚ú® ‡∏à‡∏±‡πà‡∏ß‡∏î‡πà‡∏ß‡∏ô 1 ‡πÉ‡∏ö</button>
    </div>

    <div class="card pad" style="margin-top:16px">
      <div class="row">
        <div>
          <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (optional)</label>
          <input id="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô: Gelly" />
          <label for="question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ)</label>
          <textarea id="question" rows="5" placeholder="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å, ‡∏á‡∏≤‡∏ô, ‡πÄ‡∏á‡∏¥‡∏ô, ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå, ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà ‡∏Ø‡∏•‡∏Ø"></textarea>
          <div style="display:flex; align-items:center; justify-content:space-between; margin-top:8px;">
            <label style="display:flex; align-items:center; gap:8px;">
              <input type="checkbox" id="seeded" checked />
              ‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (seed)
            </label>
            <span class="hint">‡∏ú‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°</span>
          </div>
        </div>
        <div>
          <div class="spread-grid">
            <button class="btn choice active" data-spread="one">‡∏à‡∏±‡πà‡∏ß 1 ‡πÉ‡∏ö (Now Vibe)</button>
            <button class="btn choice" data-spread="three">3 ‡πÉ‡∏ö (‡∏≠‡∏î‡∏µ‡∏ï/‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô/‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)</button>
            <button class="btn choice" data-spread="five">5 ‡πÉ‡∏ö (‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏ï‡πá‡∏°)</button>
          </div>
          <div class="actions" style="margin-top:12px">
            <button class="btn btn-primary" id="drawBtn">üîÄ ‡∏™‡∏±‡∏ö‡πÑ‡∏û‡πà & ‡∏à‡∏±‡πà‡∏ß</button>
            <button class="btn" id="resetBtn">‚Ü©Ô∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
            <span class="hint">‡πÉ‡∏ä‡πâ 22 ‡πÑ‡∏û‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Major Arcana) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏ß‡πà‡∏≥‡πÑ‡∏û‡πà‡πÑ‡∏î‡πâ</span>
          </div>
        </div>
      </div>
    </div>

    <div id="resultWrap"></div>

    <div class="footer">‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢ ü§ç ¬∑ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏Å‡∏î‡πå‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏ô‡∏∞‡∏à‡πä‡∏∞</div>
  </div>

  <!-- html2canvas for save image -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    // Major Arcana (TH keywords)
    const MAJOR_ARCANA = [
      {id:0,name:'The Fool',th:'‡πÑ‡∏û‡πà‡∏Ñ‡∏ô‡πÇ‡∏á‡πà (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)',upright:['‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà','‡∏•‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏°‡πà','‡πÑ‡∏£‡πâ‡∏Å‡∏£‡∏≠‡∏ö'],reversed:['‡πÉ‡∏à‡∏£‡πâ‡∏≠‡∏ô','‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß','‡∏•‡∏±‡∏á‡πÄ‡∏•']},
      {id:1,name:'The Magician',th:'‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏¢‡∏≤‡∏Å‡∏•',upright:['‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏°‡∏∑‡∏≠','‡∏™‡∏Å‡∏¥‡∏•‡∏Ñ‡∏£‡∏ö'],reversed:['‡∏´‡∏•‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á','‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢']},
      {id:2,name:'The High Priestess',th:'‡∏™‡∏ï‡∏£‡∏µ‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä',upright:['‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö','‡∏ü‡∏±‡∏á‡πÉ‡∏à'],reversed:['‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏ç‡∏≤‡∏ì','‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠']},
      {id:3,name:'The Empress',th:'‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥‡∏ô‡∏µ',upright:['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå','‡∏î‡∏π‡πÅ‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å'],reversed:['‡∏î‡∏π‡πÅ‡∏•‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏à‡∏ô‡∏•‡πâ‡∏≤','‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏õ‡∏¢‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ô‡∏¥‡∏î']},
      {id:4,name:'The Emperor',th:'‡∏à‡∏±‡∏Å‡∏£‡∏û‡∏£‡∏£‡∏î‡∏¥',upright:['‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á','‡∏ß‡∏¥‡∏ô‡∏±‡∏¢','‡∏ú‡∏π‡πâ‡∏ô‡∏≥'],reversed:['‡πÅ‡∏Ç‡πá‡∏á‡πÑ‡∏õ','‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏à‡∏±‡∏î']},
      {id:5,name:'The Hierophant',th:'‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä',upright:['‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤','‡∏Ñ‡∏£‡∏π/‡πÄ‡∏°‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå','‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏û‡∏¥‡∏ò‡∏µ'],reversed:['‡∏ô‡∏≠‡∏Å‡∏Å‡∏£‡∏≠‡∏ö','‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏ö']},
      {id:6,name:'The Lovers',th:'‡∏Ñ‡∏ô‡∏£‡∏±‡∏Å',upright:['‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÉ‡∏à','‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô'],reversed:['‡∏•‡∏±‡∏á‡πÄ‡∏•‡πÉ‡∏à','‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå']},
      {id:7,name:'The Chariot',th:'‡∏£‡∏ñ‡∏®‡∏∂‡∏Å',upright:['‡∏ä‡∏±‡∏¢‡∏ä‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏ô‡∏±‡∏¢','‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤'],reversed:['‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏´‡∏•‡∏∏‡∏î','‡∏û‡∏∏‡πà‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î']},
      {id:8,name:'Strength',th:'‡∏û‡∏•‡∏±‡∏á‡πÉ‡∏à',upright:['‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô‡πÅ‡∏ï‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏Å‡∏£‡πà‡∏á','‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á'],reversed:['‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á','‡∏ù‡∏∑‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ']},
      {id:9,name:'The Hermit',th:'‡∏§‡πÖ‡∏©‡∏µ',upright:['‡∏ñ‡∏≠‡∏¢‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô','‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡∏†‡∏≤‡∏¢‡πÉ‡∏ô'],reversed:['‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ','‡∏Ç‡∏≤‡∏î‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏ô‡∏≠‡∏Å']},
      {id:10,name:'Wheel of Fortune',th:'‡∏Å‡∏á‡∏•‡πâ‡∏≠‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤',upright:['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏î‡∏µ','‡∏ß‡∏á‡∏à‡∏£‡πÉ‡∏´‡∏°‡πà'],reversed:['‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô','‡∏Ñ‡∏∏‡∏°‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î']},
      {id:11,name:'Justice',th:'‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°',upright:['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏õ‡∏£‡∏≤‡∏Å‡∏è','‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö'],reversed:['‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö','‡∏≠‡∏Ñ‡∏ï‡∏¥']},
      {id:12,name:'The Hanged Man',th:'‡πÅ‡∏Ç‡∏ß‡∏ô‡∏Ñ‡∏≠',upright:['‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà','‡∏£‡∏≠‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢'],reversed:['‡∏£‡∏≠‡πÄ‡∏Å‡πâ‡∏≠','‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏•‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô']},
      {id:13,name:'Death',th:'‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î/‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà',upright:['‡∏õ‡∏¥‡∏î‡∏ö‡∏ó‡πÄ‡∏Å‡πà‡∏≤','‡∏£‡∏µ‡∏ö‡∏π‡∏ï‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï'],reversed:['‡∏¢‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß','‡∏Å‡∏•‡∏±‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô']},
      {id:14,name:'Temperance',th:'‡∏û‡∏≠‡∏î‡∏µ‡∏û‡∏≠‡πÄ‡∏´‡∏°‡∏≤‡∏∞',upright:['‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå','‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö'],reversed:['‡∏™‡∏∏‡∏î‡πÇ‡∏ï‡πà‡∏á','‡∏ú‡∏™‡∏°‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ï‡∏±‡∏ß']},
      {id:15,name:'The Devil',th:'‡∏û‡∏±‡∏ô‡∏ò‡∏ô‡∏≤‡∏Å‡∏≤‡∏£',upright:['‡∏¢‡∏∂‡∏î‡∏ï‡∏¥‡∏î/‡∏•‡πà‡∏≠‡πÉ‡∏à','‡∏î‡∏µ‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î'],reversed:['‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å','‡∏£‡∏π‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å']},
      {id:16,name:'The Tower',th:'‡∏´‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ñ‡∏•‡πà‡∏°',upright:['‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏â‡∏±‡∏ö‡∏û‡∏•‡∏±‡∏ô','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏™‡∏∞‡πÄ‡∏ó‡∏∑‡∏≠‡∏ô'],reversed:['‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡∏•‡∏á','‡∏£‡∏≠‡∏¢‡∏£‡πâ‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡πà‡∏≠‡∏°']},
      {id:17,name:'The Star',th:'‡∏î‡∏≤‡∏ß‡∏ô‡∏≥‡∏ó‡∏≤‡∏á',upright:['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á','‡πÄ‡∏¢‡∏µ‡∏¢‡∏ß‡∏¢‡∏≤','‡∏≠‡∏¥‡∏ô‡∏™‡πÑ‡∏õ‡∏£‡πå'],reversed:['‡∏ó‡πâ‡∏≠‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß','‡∏Ç‡∏≤‡∏î‡∏®‡∏£‡∏±‡∏ó‡∏ò‡∏≤']},
      {id:18,name:'The Moon',th:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏•‡∏ß‡∏á‡∏ï‡∏≤',upright:['‡∏™‡∏±‡∏ö‡∏™‡∏ô/‡∏ù‡∏±‡∏ô','‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á'],reversed:['‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå','‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á']},
      {id:19,name:'The Sun',th:'‡∏ï‡∏∞‡∏ß‡∏±‡∏ô',upright:['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'],reversed:['‡∏î‡∏µ‡πÅ‡∏ï‡πà‡∏î‡∏µ‡∏ä‡πâ‡∏≤','‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà']},
      {id:20,name:'Judgement',th:'‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤',upright:['‡∏ï‡∏∑‡πà‡∏ô‡∏£‡∏π‡πâ/‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï','‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏û‡∏•‡∏±‡∏á'],reversed:['‡∏ï‡∏¥‡∏î‡∏≠‡∏î‡∏µ‡∏ï','‡∏î‡∏∏‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á']},
      {id:21,name:'The World',th:'‡πÇ‡∏•‡∏Å‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',upright:['‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå','‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏õ'],reversed:['‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à','‡∏´‡∏•‡∏∏‡∏°‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢']},
    ];

    const SPREADS = {
      one: { key:'one', label:'‡∏à‡∏±‡πà‡∏ß 1 ‡πÉ‡∏ö (Now Vibe)', positions:['‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏£‡∏π‡πâ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ']},
      three: { key:'three', label:'3 ‡πÉ‡∏ö (‡∏≠‡∏î‡∏µ‡∏ï/‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô/‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï)', positions:['‡∏≠‡∏î‡∏µ‡∏ï','‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô','‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï']},
      five: { key:'five', label:'5 ‡πÉ‡∏ö (‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏ï‡πá‡∏°)', positions:['‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå','‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ','‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô','‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥','‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå']},
    };

    // Seeded RNG
    function cyrb128(str){
      let h1 = 1779033703, h2 = 3144134277, h3 = 1013904242, h4 = 2773480762;
      for (let i=0,k;i<str.length;i++){
        k = str.charCodeAt(i);
        h1 = h2 ^ Math.imul(h1 ^ k, 597399067);
        h2 = h3 ^ Math.imul(h2 ^ k, 2869860233);
        h3 = h4 ^ Math.imul(h3 ^ k, 951274213);
        h4 = h1 ^ Math.imul(h4 ^ k, 2716044179);
      }
      h1 = Math.imul(h3 ^ (h1>>>18), 597399067);
      h2 = Math.imul(h4 ^ (h2>>>22), 2869860233);
      h3 = Math.imul(h1 ^ (h3>>>17), 951274213);
      h4 = Math.imul(h2 ^ (h4>>>19), 2716044179);
      return [(h1^h2^h3^h4)>>>0, (h2^h1)>>>0, (h3^h1)>>>0, (h4^h1)>>>0];
    }
    function sfc32(a,b,c,d){
      return function(){
        a>>>==0; b>>>==0; c>>>==0; d>>>==0;
        let t = (a + b) | 0;
        a = b ^ (b >>> 9);
        b = (c + (c << 3)) | 0;
        c = (c << 21) | (c >>> 11);
        d = (d + 1) | 0;
        t = (t + d) | 0;
        c = (c + t) | 0;
        return (t >>> 0) / 4294967296;
      }
    }
    function getRng(seedStr){ const [a,b,c,d] = cyrb128(seedStr); return sfc32(a,b,c,d); }

    function pickCards(count, useSeed, seedStr){
      const rng = useSeed ? getRng(seedStr) : Math.random;
      const deck = MAJOR_ARCANA.slice();
      for(let i=deck.length-1;i>0;i--){
        const j = Math.floor(rng()*(i+1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
      return deck.slice(0, count).map(c => ({...c, reversed: rng() < 0.5}));
    }

    // UI State
    let spreadKey = 'one';
    const choices = document.querySelectorAll('.choice');
    choices.forEach(btn => btn.addEventListener('click', () => {
      choices.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      spreadKey = btn.dataset.spread;
    }));

    document.getElementById('quickDraw').addEventListener('click', () => {
      spreadKey = 'one';
      choices.forEach(b => b.classList.remove('active'));
      document.querySelector('.choice[data-spread="one"]').classList.add('active');
      drawNow();
    });

    document.getElementById('drawBtn').addEventListener('click', drawNow);
    document.getElementById('resetBtn').addEventListener('click', () => {
      document.getElementById('resultWrap').innerHTML = '';
    });

    function drawNow(){
      const name = document.getElementById('name').value.trim();
      const question = document.getElementById('question').value.trim();
      const seeded = document.getElementById('seeded').checked;
      const seedStr = (name + '|' + question).trim() || 'vibe';

      const spread = SPREADS[spreadKey];
      const cards = pickCards(spread.positions.length, seeded, seedStr);
      const reading = { when: new Date(), spread, cards, name, question, seed: seeded ? seedStr : null };

      renderReading(reading);
    }

    function renderReading(r){
      const wrap = document.getElementById('resultWrap');
      const t = new Date(r.when);
      const header = `
        <div style="display:flex; align-items:flex-end; justify-content:space-between; gap:10px; flex-wrap:wrap; margin-bottom:8px">
          <div>
            <div style="font-size:20px; font-weight:700">‡∏ú‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ ‚Äî ${r.spread.label} <span class="muted" style="font-size:12px">${t.toLocaleString()}</span></div>
            ${(r.name || r.question) ? `<div class="muted" style="font-size:13px; margin-top:4px">
              ${r.name ? ('‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ' + r.name) : ''}
              ${(r.name && r.question) ? ' ¬∑ ' : ''}
              ${r.question ? ('‚Äú' + r.question + '‚Äù') : ''}
            </div>` : ''}
          </div>
          <div class="hint">seed: ${r.seed || 'random'}</div>
        </div>
      `;

      const cardsHtml = r.spread.positions.map((pos, idx) => {
        const c = r.cards[idx];
        const kw = (c.reversed ? c.reversed : c.upright).slice(0,3).join(' ‚Ä¢ ');
        const reversedBadge = c.reversed ? `<span class="badge">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏±‡∏ß</span>` : '';
        const id = `tarot-${Date.now()}-${idx}`;
        return `
          <div class="card pad">
            <div class="muted" style="font-size:12px; text-transform:uppercase; margin-bottom:6px">${pos}</div>
            <div class="tarot" id="${id}" data-flipped="true">
              <div class="front">
                <div class="muted" style="font-size:13px">‡πÉ‡∏ö‡∏ó‡∏µ‡πà ${idx+1}</div>
                <div style="font-size:18px; font-weight:800; line-height:1.2">${c.th} ${reversedBadge}</div>
                <div class="muted" style="font-size:12px"><span style="opacity:.7; margin-right:4px">‡∏Ñ‡∏µ‡∏¢‡πå‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î:</span>${kw}</div>
              </div>
              <div class="back">
                <div>
                  <div style="font-size:28px; font-weight:900; text-shadow:0 0 12px rgba(168,85,247,.8)">TAROT</div>
                  <div class="hint">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà</div>
                </div>
              </div>
            </div>
          </div>
        `;
      }).join('');

      const summaryLines = buildSummaryLines(r).map(li => `<li>${li}</li>`).join('');
      const captureId = `capture-${Date.now()}`;

      wrap.innerHTML = `
        <section class="card pad" id="${captureId}" style="margin-top:16px">
          ${header}
          <div class="cards">${cardsHtml}</div>
          <div class="card pad" style="margin-top:16px">
            <div style="font-weight:600; margin-bottom:8px">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß (TL;DR)</div>
            <div class="summary"><ul>${summaryLines}</ul></div>
          </div>
        </section>
        <div class="actions">
          <button class="btn" id="copyBtn">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
          <button class="btn" id="saveBtn">üì∑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ</button>
          <button class="btn btn-share" id="shareBtn">üì§ ‡πÅ‡∏ä‡∏£‡πå</button>
        </div>
      `;

      // flip handlers
      r.spread.positions.forEach((_, idx) => {
        const el = document.getElementById(`tarot-${t.getTime()}-${idx}`);
        if(!el) return;
        el.addEventListener('click', () => {
          const flipped = el.getAttribute('data-flipped') === 'true';
          el.setAttribute('data-flipped', flipped ? 'false' : 'true');
          el.classList.toggle('flipped');
        });
      });

      // actions
      document.getElementById('copyBtn').onclick = () => {
        const text = formatReadingText(r);
        navigator.clipboard.writeText(text).then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‚ú®'));
      };
      document.getElementById('saveBtn').onclick = async () => {
        const node = document.getElementById(captureId);
        const canvas = await html2canvas(node, {backgroundColor: null, scale: 2});
        const link = document.createElement('a');
        link.download = `tarot-reading-${Date.now()}.png`;
        link.href = canvas.toDataURL('image/png');
        link.click();
      };
      document.getElementById('shareBtn').onclick = async () => {
        const node = document.getElementById(captureId);
        if(!navigator.share){ alert('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Share Sheet ‚Äî ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ'); return; }
        const canvas = await html2canvas(node, {backgroundColor: null, scale: 2});
        canvas.toBlob(async (blob)=>{
          const file = new File([blob], 'reading.png', {type:'image/png'});
          try{
            await navigator.share({title:'Tarot Reading ‚ú®', text: r.question || 'My vibe rn', files:[file]});
          }catch(e){ console.log(e); alert('‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞'); }
        });
      };
    }

    function buildSummaryLines(reading){
      const { spread, cards } = reading;
      const lines = [];
      const pos = spread.positions;
      for(let i=0;i<pos.length;i++){
        const c = cards[i];
        const kw = (c.reversed ? c.reversed : c.upright).slice(0,3).join('/');
        lines.push(`${pos[i]}: ${c.th} ‚Äî ${kw}`);
      }
      const vibes = vibeSlogan(cards);
      lines.push(`üëâ ‡πÇ‡∏ü‡∏Å‡∏±‡∏™: ${vibes.tip}`);
      return lines;
    }

    function vibeSlogan(cards){
      const positive = ['The Sun','The Star','The World','Strength','Temperance','The Magician','The Empress','The Chariot','Justice'];
      const spicy = ['The Tower','The Devil','Death','The Moon','The Hanged Man','Wheel of Fortune'];
      let score = 0;
      for(const c of cards){
        if(positive.includes(c.name) && !c.reversed) score += 1;
        if(spicy.includes(c.name)) score -= (c.reversed ? 0.5 : 1);
      }
      const tip = score >= 1
        ? '‡∏Ç‡∏≠‡∏á‡∏î‡∏µ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Äî ‡∏Å‡∏•‡πâ‡∏≤‡∏£‡∏±‡∏ö ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÉ‡∏™‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏•‡∏á‡∏á‡∏≤‡∏ô üíÖ'
        : score <= -1
        ? '‡∏ä‡πà‡∏ß‡∏á Hard Mode ‚Äî ‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤ ‡∏≠‡∏±‡∏õ‡∏ô‡∏¥‡∏™‡∏±‡∏¢/‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ö‡∏∏‡∏Å üîß'
        : '‡∏ä‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏ä‡∏±‡∏ß‡∏£‡πå ‚Äî ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∏‡∏¢‡∏ï‡∏£‡∏á ‡πÜ ‡∏ï‡∏±‡πâ‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô üß≠';
      return {score, tip};
    }

    function formatReadingText(reading){
      const lines = buildSummaryLines(reading);
      const title = `üîÆ Tarot ‚Äî ${reading.spread.label}`;
      const head = [
        reading.name ? `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö: ${reading.name}` : null,
        reading.question ? `‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: ${reading.question}` : null,
        `‡πÄ‡∏ß‡∏•‡∏≤: ${reading.when.toLocaleString()}`,
      ].filter(Boolean);
      return [title, ...head, '', ...lines, '', '(‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï)'].join('\\n');
    }
  </script>
</body>
</html>
